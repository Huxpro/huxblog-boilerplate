---
layout:     post
title:      "分子动力学模拟所需的软件"
subtitle:   "Pre-request on Molecular Dynamics Simulation"
date:       2020-02-02 12:00:00
author:     "Ming Huang"
header-img: "img/sunrise-01.jpg"
tags:
    - Molecular Dynamic Simulation
    - 分子动力学模拟软件
    - 视图软件
---

## 前言

  一直有朋友想从实验方向转到分子模拟方向，然后问我难不难，能不能很快转成功。这个说实在真的很难回答。但是我个人认为两个方向的思路开始的时候是完全不一样的，但是到最后融会贯通之后，又是统一起来的。这个我是从我尊敬的老板Dr.Larson那里得出来的结论。他最开始是做实验的，多年的积累让他成为了实验理论都达到了大牛的水平。这个时候分子模拟对于他来说只是验证理论的工具，自然也是驾轻就熟。但是在初学阶段肯定还是不同的。不论是思路还是手段。以下介绍一些我认为，如果要转成分子动力学模拟方向可能需要的东西。（个人经验，不一定适用所有人）

## 正文
  对于科研来说，最重要的就是结果的准确性和可靠性。实验上，只要结果可以重复，自然认为该结果是可靠的，但是模拟不一定。因为模拟过程其实就是理论模型的验证过程，虽然中间加入了很多随机的因素，还是很容易得到一致的结果。这就需要远比实验更多的体系和模型，来验证整个模型和过程是准确，可靠和普适的。

  由于所需要的验证的模拟实验很多，所以最终得到的数据量也会比试验要多的多。所以要会一定的代码用来批量化处理数据。

  除了以上两个方面，还有很重要的一各方面。分子模拟是对理论模型的适用性的一种测试过程和手段。所以前提就是对这个理论模型需要很清晰的认识。分子模拟过程是不允许出现黑匣子的。模拟的过程中，一定要弄清整个过程是计算什么的，如何计算的。而不是说别人用同样的软件，同样的步骤得到了答案。那么你用相同的方法在你的体系就一定会好用。

  归功于电脑硬件的发展，近几年分子动力学有了很大的发展。但是可以说所有方向还是远远落后于实验的研究进展的。大部分分子模拟还是处在验证理论模型的阶段。所以实验可以是先做实验，然后通过结论去推测这个黑匣子里面是什么。但是模拟必须是先知道黑匣子里面是什么，然后测试这个黑匣子里面的理论是不是适用于你所研究的体系。我也认为这个是最大的区别。

  说了这么多，来讲讲如果确定了要以分子模拟作为科研的方向，需要学些什么语言和软件吧。由于我个人的局限，我只会着重介绍一些我用到过的软件和语言。
  
### 分子动力学需要软件
其实分子模拟说白了只是另外一种实验模式，用电脑的计算代替了人的实验操作。所以整个过程还是很类似的。开始一个实验，人们需要的是：1）原料， 2）搭建实验仪器，3）具体的实验流程，4）分析测试得到实验结果。其实分子模拟也是对应类似的。我们需要1）所研究体系的数学模型， 2）确定用何种模拟方法（流程）计算体系的何种性质，并用动力学模拟软件开始动力学模拟，3）分析得到的模拟结果。对应实现这三步也有不同的软件和方法。这里先简单介绍，以后每个再详细讲解。

#### 1. 体系模型
* 建立模型
  * 蛋白质
  蛋白质模型虽然说是很复杂的。但是好在人们通过这么多年的努力，已经有成熟的手段可以直接将实验得到的稳定的结构直接转成数学模型。而这些数学模型可以很方便的直接被各种分子模拟软件直接读取然后进行分子动力学模拟。在数据库http://www.rcsb.org/中，可以很方便找到。每个蛋白质都有他的本身的特征代号。并且对于相同的氨基酸序列的模型，还有不用分辨率的模型，可以用来不同的研究。

  * 流体模型
  一般的流体模型，其实可以直接在分子模拟软件里面直接生成。譬如想要模拟“水在矩形截面的管道里流通”。其过程就是在simulation cell的两侧加上墙壁，然后剩余的空间填满水分子就好。GROMACS，Material studio都可以做到。但是对于一些复杂的流体模型，还是需要自己写代码建模的。我们当时研究微通道时候的模型是通过Hoomd-blue进行建模的，也是需要一些预先的编程建模。

  * 高分子建模
  对于热塑性的高分子链，整个体系都是很多高分子链混合纠缠在一起。这种链可以很方便的生成。无论是软件还是自己编程。同时也可以用反应力场reax-ff，在跑动力学的过程中建模。但是热固性塑料，其形成的是空间网状结构。这个目前看通用的可用的软件是material studio但是是一个商用软件，并且速度不快。最好的办法还是根据自己的体系开发适用自己体系的代码。
* 观察模型
  以上所提到的这些都是建立模型，但是这些模型都是一堆数字，很难直观的去观察。所以这就需要一些软件帮助我们把这些数字模型转化成可以直观看到的模型。我常用的有以下几种：
  * VMD
    UIUC开发的一款软件，全平台都有。并且免费开源。
  * Pymol
    同样免费开源，全平台。看蛋白质模型的时候很不错，渲染很好
  * Avogadro
    免费开源，除了看模型外，还可以建模（高分子，蛋白质等），对分子进行简单的拖动，能量最小化，简单的动力学模拟等操作。

####  2. 体系性质 & 动力学模拟
  在跑动力学模拟之前，一定要清楚要收集什么样的性质。需要用什么样的动力学模拟方法获得。例如像比较简单的，密度，只是要一般的NPT动力学模拟就够了。而像结合能这种，就需要确定动力学方法了。确定好模拟方法和流程之后，就需要使用软件尽心动力学模拟了。现在已经很方便了，不需要自己写动力学模拟引擎，那个可真的是宏大的工程，不仅需要对量子力学有很深的理解，并且编程能力也要极强。目前已经有很多开源的动力学模拟的软件了。譬如GROMACS, LAMMPS, AMBER, NAMD, CHARMM。其中AMBER, CHARMM是收费的。其他皆为开源的，AMBER部分工具也是开源的。我个人经常使用的是GROMACS。这个软件在进行多核运算的时候效率很高，并且已经集成了很多已知的计算函数，可以在分析数据的时候省很多力气。并且GROMACS的函数大多使用的是C++写的，如果需要更改个别函数以适应自己的算法的话也是蛮方便的。LAMMPS是另外一个常用的，它最大的特色就是开放。你可以根据需要定义很多自己的分析函数和运算，并且对于粗粒化模型建立还是蛮方便的。

#### 3. 分析数据
  在跑完所有的模拟之后，对于数据的提取和分析也是格外重要的。由于动力学模拟的数据量很大，所以使用各种脚本（bash, python, unix, etc)进行批量化分析数据是很关键的。而这除了要求一定的编程能力，就是需要对分析过程中涉及的所有函数都要清楚，否则真的是失之毫厘谬以千里。

以上就是我认为的开始做分子模拟的时候所有需要的基础的软件和想法。



