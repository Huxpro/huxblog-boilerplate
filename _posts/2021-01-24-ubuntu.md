---
layout:     post
title:      "Ubuntu常用操作备忘录"
subtitle:   ""
date:       2021-01-24
author:     "SirJamie"
header-img: "img/head-post/post-bg-2020.jpg"
tags:
    - Linux
---


## 统计个数

### 统计当前目录下文件的个数（不包括子目录）
```
ls -l | grep "^-" | wc -l
```

### 统计当前目录下文件的个数（不包括子目录）
```
ls -l | grep "^d" | wc -l
```

### 统计当前目录下文件的个数（包括子目录）
```
ls -lR| grep "^-" | wc -l
```

### 查看某目录下文件夹(目录)的个数（包括子目录）
```
ls -lR | grep "^d" | wc -l
```
---


## 批量解压

### 至指定目录
```
ls *.tar | xargs -i tar xvf {} -C your_target_dir
```

### 至当前目录
```
ls *.tar | xargs -n1 tar xvf
```
---

## Git 忽略 .DS_Store
在.gitignore中加入
```
**/.DS_Store
```
---

## Mac‘s LL
区别在于单位固定为Byte
```
ls -alF
```
---


## killall
停止某一用户的全部进程
```
killall -u username
```
---

## pkill
kill全部python的进程
```
pkill -9 python
```

## scp
文件传输
```
scp -P 15654 zhouzheyuan@10.192.9.10:/var/lib/docker/data/datasets/coco/test2017.zip ./
```
---

## nohup
后台运行
```
nohup bash ./train.sh >> out.log 2>&1 &
```
---

## scp后台运行
针对直接nohup无法输入密码的情况

### 1. scp
正常`scp`，并输入密码
```
[root@oradb30 ~]# scp -r /u01/media/Disk1/ 192.168.1.31:/u01/media/
reverse mapping checking getaddrinfo for bogon failed - POSSIBLE BREAK-IN ATTEMPT!
root@192.168.1.31's password: 
...
filegroup2.jar                                                                                                                                              100%   84KB  83.8KB/s   00:00    
filegroup9.jar                                                                                                                                              100%   16KB  16.1KB/s   00:00    
```

### 2. Ctrl + Z
输入`Ctrl + Z`暂停

可通过`jobs`查看
```
[root@oradb30 ~]# jobs
[1]+  Stopped                 scp -r /u01/media/Disk1/ 192.168.1.31:/u01/media/
```

### 3. bg
将该任务号放入后台
```
bg %1
```

可通过`jobs`查看
```
[root@oradb30 media]# jobs
[1]+  Running                 scp -r Disk1/ 192.168.1.31:/u01/media/ &
```

### 4. disown -h
将这个作业忽略HUP信号
```
disown -h %1
```

可通过`jobs`查看
```
[root@oradb30 media]# jobs
[1]+  Running                 scp -r Disk1/ 192.168.1.31:/u01/media/ &
```

通过`ps -ef|grep scp`查看任务运行状态和父进程号
```
[root@oradb30 media]# ps -ef|grep scp
root     12704 12638  0 05:19 pts/0    00:00:01 scp -r Disk1  192.168.1.31 /u01/media/
root     12705 12704  8 05:19 pts/0    00:00:17 /usr/bin/ssh -x -oForwardAgent no -oPermitLocalCommand no -oClearAllForwardings yes 192.168.1.31 scp -r -t /u01/media/
root     12823 12638  0 05:22 pts/0    00:00:00 grep scp
```
---

## du
显示文件夹大小
```
du -sh
```
---

## pip 环境迁移
Source Environment
```
pip freeze > requirements.txt
```

Target Enviroment
```
pip install -r requirements.txt
```
---

## Conda 环境迁移
Source Environment
```
conda list --explicit > spec-list.txt
```

Target Enviroment
```
conda create --name env-name --file spec-list.txt
```
---

## Reference
[Linux统计文件夹下的文件数目](http://noahsnail.com/2017/02/07/2017-02-07-Linux统计文件夹下的文件数目/)

[Ubuntu 常用压缩&解压命令](https://sirjamie.github.io/2020/10/24/tar/)

[Linux下载加速大全](https://sirjamie.github.io/2020/11/16/boost/)

[Git忽略.DS_Store文件](https://orianna-zzo.github.io/sci-tech/2018-01/mac中git忽略.ds_store文件/)

[Linux scp 设置nohup后台运行](https://www.cnblogs.com/jyzhao/p/6253728.html)